<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Nubificus LTD"><link rel=canonical href=https://nubificus.github.io/cloud-native-iot/main/developer/build_automation.html><link rel=prev href=applications.html><link rel=next href=firmware_packaging.html><link rel=icon href=../assets/images/cniot-logo.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>Build Automation - Cloud-native IoT</title><link rel=stylesheet href=../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/_mkdocstrings.css><link rel=stylesheet href=../assets/stylesheets/theme.f2b0e9.min.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-X2S0PFR6ZY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-X2S0PFR6ZY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-X2S0PFR6ZY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#build-automation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest released version. <a href=../.. class=md-content__link> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL(".."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../index.html title="Cloud-native IoT" class="md-header__button md-logo" aria-label="Cloud-native IoT" data-md-component=logo> <img src=../assets/images/cniot-logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Cloud-native IoT </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Build Automation </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=vaccel data-md-color-primary=light-blue data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/nubificus/cloud-native-iot title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> nubificus/cloud-native-iot </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../index.html title="Cloud-native IoT" class="md-nav__button md-logo" aria-label="Cloud-native IoT" data-md-component=logo> <img src=../assets/images/cniot-logo.svg alt=logo> </a> Cloud-native IoT </label> <div class=md-nav__source> <a href=https://github.com/nubificus/cloud-native-iot title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> nubificus/cloud-native-iot </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../getting-started/index.html class="md-nav__link "> <span class=md-ellipsis> Getting started </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../getting-started/prerequisites.html class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=../getting-started/quickstart.html class=md-nav__link> <span class=md-ellipsis> Quickstart Guide </span> </a> </li> <li class=md-nav__item> <a href=../getting-started/installation.html class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../architecture/index.html class="md-nav__link "> <span class=md-ellipsis> Architecture </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../architecture/ota-workflow.html class=md-nav__link> <span class=md-ellipsis> OTA Update Workflow </span> </a> </li> <li class=md-nav__item> <a href=../architecture/onboarding.html class=md-nav__link> <span class=md-ellipsis> Onboarding Workflow </span> </a> </li> <li class=md-nav__item> <a href=../architecture/flashjobworkflow.html class=md-nav__link> <span class=md-ellipsis> FlashJob Operator Lifecycle </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../components/index.html class="md-nav__link "> <span class=md-ellipsis> Components </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../components/attestation-server.html class=md-nav__link> <span class=md-ellipsis> Attestation Server </span> </a> </li> <li class=md-nav__item> <a href=../components/ota-service.html class=md-nav__link> <span class=md-ellipsis> ESP32 OTA Component </span> </a> </li> <li class=md-nav__item> <a href=../components/esp32-akri.html class=md-nav__link> <span class=md-ellipsis> ESP32 Akri Component </span> </a> </li> <li class=md-nav__item> <a href=../components/ota-agent.html class=md-nav__link> <span class=md-ellipsis> OTA Agent </span> </a> </li> <li class=md-nav__item> <a href=../components/akri-dh.html class=md-nav__link> <span class=md-ellipsis> Secure HTTP Discovery Handler </span> </a> </li> <li class=md-nav__item> <a href=../components/akri-integration.html class=md-nav__link> <span class=md-ellipsis> Akri Integration for Onboarding </span> </a> </li> <li class=md-nav__item> <a href=../components/flashjob.html class=md-nav__link> <span class=md-ellipsis> Flashjob Operator </span> </a> </li> <li class=md-nav__item> <a href=../components/flashjob-pod.html class=md-nav__link> <span class=md-ellipsis> FlashJob Pod </span> </a> </li> <li class=md-nav__item> <a href=../components/go-akri.html class=md-nav__link> <span class=md-ellipsis> Akri Discovery Handler package for Go </span> </a> </li> <li class=md-nav__item> <a href=../components/firmware-signing.html class=md-nav__link> <span class=md-ellipsis> Firmware Signing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../tutorials/ota-agent.html class=md-nav__link> <span class=md-ellipsis> OTA Agent </span> </a> </li> <li class=md-nav__item> <a href=../tutorials/dice-auth.html class=md-nav__link> <span class=md-ellipsis> Attestation Server </span> </a> </li> <li class=md-nav__item> <a href=../tutorials/ota-service.html class=md-nav__link> <span class=md-ellipsis> ESP32 OTA Component </span> </a> </li> <li class=md-nav__item> <a href=../tutorials/akri-esp32.html class=md-nav__link> <span class=md-ellipsis> ESP32 Akri Component </span> </a> </li> <li class=md-nav__item> <a href=../tutorials/filter_uuid.html class=md-nav__link> <span class=md-ellipsis> FlashJob Operator: filter_uuid.py Tutorial </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Developers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Developers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=architecture.html class=md-nav__link> <span class=md-ellipsis> System Architecture </span> </a> </li> <li class=md-nav__item> <a href=applications.html class=md-nav__link> <span class=md-ellipsis> Application development </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Build Automation </span> <span class="md-nav__icon md-icon"></span> </label> <a href=build_automation.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Build Automation </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#firmware-build-practices class=md-nav__link> <span class=md-ellipsis> Firmware Build Practices </span> </a> <nav class=md-nav aria-label="Firmware Build Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#aws-iot class=md-nav__link> <span class=md-ellipsis> AWS IoT </span> </a> </li> <li class=md-nav__item> <a href=#azure-iot class=md-nav__link> <span class=md-ellipsis> Azure IoT </span> </a> </li> <li class=md-nav__item> <a href=#industry-vs-our-ci-based-method class=md-nav__link> <span class=md-ellipsis> Industry VS Our CI-based Method </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#esp-idf-build class=md-nav__link> <span class=md-ellipsis> ESP-IDF Build </span> </a> </li> <li class=md-nav__item> <a href=#ci-powered-build-with-esp32-build class=md-nav__link> <span class=md-ellipsis> CI-Powered Build with esp32-build </span> </a> <nav class=md-nav aria-label="CI-Powered Build with esp32-build"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#building-process class=md-nav__link> <span class=md-ellipsis> Building Process </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=firmware_packaging.html class=md-nav__link> <span class=md-ellipsis> Firmware Packaging </span> </a> </li> <li class=md-nav__item> <a href=initial_flash_packaging.html class=md-nav__link> <span class=md-ellipsis> Initial Flash Packaging </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../api/index.html class="md-nav__link "> <span class=md-ellipsis> API </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../api/openapi-spec.html class=md-nav__link> <span class=md-ellipsis> Device API </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../faq.html class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#firmware-build-practices class=md-nav__link> <span class=md-ellipsis> Firmware Build Practices </span> </a> <nav class=md-nav aria-label="Firmware Build Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#aws-iot class=md-nav__link> <span class=md-ellipsis> AWS IoT </span> </a> </li> <li class=md-nav__item> <a href=#azure-iot class=md-nav__link> <span class=md-ellipsis> Azure IoT </span> </a> </li> <li class=md-nav__item> <a href=#industry-vs-our-ci-based-method class=md-nav__link> <span class=md-ellipsis> Industry VS Our CI-based Method </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#esp-idf-build class=md-nav__link> <span class=md-ellipsis> ESP-IDF Build </span> </a> </li> <li class=md-nav__item> <a href=#ci-powered-build-with-esp32-build class=md-nav__link> <span class=md-ellipsis> CI-Powered Build with esp32-build </span> </a> <nav class=md-nav aria-label="CI-Powered Build with esp32-build"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#building-process class=md-nav__link> <span class=md-ellipsis> Building Process </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path> <ol class=md-path__list> <li class=md-path__item> <a href=.. class=md-path__link> <span class=md-ellipsis>Developers</span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id=build-automation>Build Automation<a class=headerlink href=#build-automation title="Permanent link">🔗</a></h1> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">🔗</a></h2> <p>Building and packaging firmware for embedded devices such as ESP32 can be deceptively complex. The process typically involves managing toolchains, setting device-specific configurations, embedding application models (like TFLite), optionally signing binaries, and deploying the resulting firmware across diverse hardware targets.</p> <p>This section explains:</p> <ul> <li>Common industry practices for firmware building and update workflows.</li> <li>How ESP-IDF-based firmware is typically built.</li> <li>How our <code>esp32-build</code> automation system simplifies this process.</li> </ul> <h2 id=firmware-build-practices>Firmware Build Practices<a class=headerlink href=#firmware-build-practices title="Permanent link">🔗</a></h2> <p>Cloud providers such as AWS IoT and Azure IoT Hub offer end-to-end device management platforms. Here's how firmware build &amp; update is commonly done with them:</p> <h3 id=aws-iot>AWS IoT<a class=headerlink href=#aws-iot title="Permanent link">🔗</a></h3> <ul> <li><strong>Build</strong>: Developers manually compile firmware using <code>ESP-IDF</code> locally or via CI.</li> <li><strong>Store</strong>: The firmware is uploaded to an S3 bucket.</li> <li><strong>Update</strong>: AWS IoT Device Jobs service triggers the update by instructing the device to download and apply the firmware from S3.</li> <li><strong>Security</strong>: Optional code signing via AWS Signer. Root-of-trust is enforced at device boot.</li> </ul> <h3 id=azure-iot>Azure IoT<a class=headerlink href=#azure-iot title="Permanent link">🔗</a></h3> <ul> <li><strong>Build</strong>: Similarly to AWS, the firmware is compiled using local/CI toolchains.</li> <li><strong>Store</strong>: The firmware is uploaded to Azure Blob Storage.</li> <li><strong>Update</strong>: Azure Device Update for IoT Hub delivers the new image to registered devices via update campaigns.</li> <li><strong>Security</strong>: Supported but tightly coupled with Microsoft's toolchain and portal-based setup.</li> </ul> <h3 id=industry-vs-our-ci-based-method>Industry VS Our CI-based Method<a class=headerlink href=#industry-vs-our-ci-based-method title="Permanent link">🔗</a></h3> <table> <thead> <tr> <th>Feature</th> <th>AWS / Azure IoT</th> <th>Our Approach</th> </tr> </thead> <tbody> <tr> <td>Binary Distribution</td> <td>Blob Storage (S3 / Azure Blob)</td> <td>OCI Image Registry (Harbor, DockerHub)</td> </tr> <tr> <td>Device Targeting</td> <td>Device Shadow / Twin</td> <td>OCI image tags + Manifest</td> </tr> <tr> <td>CI/CD Integration</td> <td>CodeBuild, Azure DevOps (manual setup)</td> <td>GitHub Actions-native</td> </tr> <tr> <td>OTA Update</td> <td>Vendor-managed OTA infrastructure</td> <td><a href=https://github.com/nubificus/esp32-flashjob><code>esp32-flashjob</code></a></td> </tr> <tr> <td>Extensibility</td> <td>Vendor lock-in</td> <td>Open, OCI-compliant, portable</td> </tr> </tbody> </table> <h2 id=esp-idf-build>ESP-IDF Build<a class=headerlink href=#esp-idf-build title="Permanent link">🔗</a></h2> <p>ESP-IDF is Espressif’s official framework for building ESP32 firmware.</p> <p>A typical manual build includes:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Set up ESP-IDF environment</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>.<span class=w> </span><span class=nv>$HOME</span>/esp/esp-idf/export.sh
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=c1># Configure your target</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>idf.py<span class=w> </span>set-target<span class=w> </span>esp32s3
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># Configure project settings, PSRAM, partition table, etc.</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>idf.py<span class=w> </span>menuconfig
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=c1># Build</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>idf.py<span class=w> </span>build
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=c1># Flash the device (via USB)</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>idf.py<span class=w> </span>-p<span class=w> </span>/dev/ttyUSB0<span class=w> </span>flash
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=c1># Monitor serial output</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>idf.py<span class=w> </span>-p<span class=w> </span>/dev/ttyUSB0<span class=w> </span>monitor
</span></code></pre></div> <p>Although this works well for single-target builds, it becomes cumbersome when:</p> <ul> <li>Supporting multiple hardware variants (e.g. <code>esp32s3</code>, <code>esp32s2</code>, etc.).</li> <li>Managing different RAM configurations (e.g. quad/octal PSRAM, internal RAM).</li> <li>Creating custom partition tables based not only on the app but also on the hardware target's capabilities.</li> <li>Embedding additional files (e.g. TensorFlow Lite models) into the firmware or flash partitions.</li> <li>Signing firmware for secure boot or OTA updates.</li> </ul> <h2 id=ci-powered-build-with-esp32-build>CI-Powered Build with <code>esp32-build</code><a class=headerlink href=#ci-powered-build-with-esp32-build title="Permanent link">🔗</a></h2> <p>To solve all the above challenges, we’ve created <a href=https://github.com/nubificus/esp32-build><code>esp32-build</code></a>: a fully automated CI workflow for building and packaging firmware across many targets.</p> <h3 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">🔗</a></h3> <ul> <li><strong>Workflow:</strong> GitHub Actions <code>build.yml</code> workflow triggered by <code>ci.yml</code> when the latter is provided with a JSON input.</li> <li><strong>Input:</strong> JSON configuration file</li> <li><strong>Apps</strong>: List of applications to build, each with its own repository, branch, version, type, optional file paths to a machine-learning model and a prebuild script. It also allows defining custom variables that will be converted to environment variables.</li> <li><strong>Targets</strong>: List of hardware targets (e.g., <code>esp32s3</code>, <code>esp32s2</code>).</li> <li><strong>Builder Image</strong>: Container image containing the ESP-IDF environment.</li> <li><strong>Keys</strong>: List of signing keys (in the form of Github Secrets) for secure boot or OTA updates.</li> <li><strong>Output:</strong> Per-target signed firmware, flasher images, and multi-arch manifests.</li> </ul> <p>An example of the expected JSON input form is provided below:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=p>{</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>  </span><span class=nt>&quot;apps&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>      </span><span class=nt>&quot;repo&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;nubificus/fmnist-esp-ota&quot;</span><span class=p>,</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>      </span><span class=nt>&quot;branch&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;main&quot;</span><span class=p>,</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>      </span><span class=nt>&quot;version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;8.8.8&quot;</span><span class=p>,</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;fmnist-app&quot;</span><span class=p>,</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>      </span><span class=nt>&quot;model&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;models/simple_cnn_tf_frozen.tflite&quot;</span><span class=p>,</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>      </span><span class=nt>&quot;tensor_allocation_space&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;204800&quot;</span><span class=p>,</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=w>      </span><span class=nt>&quot;load_model_from_partition&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1&quot;</span><span class=p>,</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=w>      </span><span class=nt>&quot;prebuild&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;scripts/prepare.sh&quot;</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=w>  </span><span class=p>],</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=w>  </span><span class=nt>&quot;targets&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;esp32s3&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;esp32s3r2&quot;</span><span class=p>],</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=w>  </span><span class=nt>&quot;builder_image&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;harbor.nbfc.io/nubificus/esp-idf:x86_64-slim&quot;</span><span class=p>,</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=w>  </span><span class=nt>&quot;keys&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;ESP32_KEY3&quot;</span><span class=p>]</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=p>}</span>
</span></code></pre></div> <h3 id=building-process>Building Process<a class=headerlink href=#building-process title="Permanent link">🔗</a></h3> <p>While the building process is quite complex and involves several steps, the most significant ones are as follows:</p> <ol> <li> <p>In case the user has provided a model path in the JSON input, the first step ensures that the model is included in the final container image. The model is also uploaded to our S3 storage server.</p> </li> <li> <p>The project repository is fetched and the workflow checks out the specified branch.</p> </li> <li> <p>Any additional app variables provided by the user are defined as environment variables.</p> </li> <li> <p>If any target device has the suffixes <code>r2</code> or <code>r8</code>, the workflow will set the <code>quad_psram</code> or <code>oct_psram</code> environment variables, respectively. The user can utilize these variables in their project builder to enable the external PSRAM of their device.</p> </li> <li> <p>If the user has specified a "prebuild" field that points to a preparation script within the project repository, the workflow will execute it.</p> </li> <li> <p>Using the provided <code>"builder_image"</code>, which has the ESP-IDF framework installed, the workflow performs the actual esp32 build for each specified esp32 target device.</p> </li> <li> <p>If the <code>"keys"</code> field is not empty, the workflow will sign the firmware generated in the previous step for each secret key.</p> </li> <li> <p>Similar to the model, the firmware binary artifacts are also included in the container image and uploaded to our S3 storage server.</p> </li> <li> <p>For each target device, a container image containing only the firmware image is constructed for later use by the flash job for OTA updates. However, instead of producing multiple separate container images, the workflow outputs a single manifest that includes all of them, allowing the user to check out their preferred type.</p> </li> <li> <p>Finally, the workflow creates an initial flashing container image that the user can use to physically flash the esp32 device with the previously generated binary artifacts. This container image contains binary artifacts for all device types, and the user can specify the desired type during the <code>docker run</code> execution. Additionally, since flashing container images are constructed for both x86 and ARM architectures, the workflow generates a single manifest containing both.</p> </li> </ol> <p><img alt="Figure 1" src=../assets/images/esp32-build.png> <em>Figure 1: Example of workflow execution flow illustrating the creation of three firmware building jobs, three firmware container building jobs, and two flashing container building jobs for each of the three device types and two architectures. Additionally, there are two final jobs for assembling the containers into single manifests.</em></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=applications.html class="md-footer__link md-footer__link--prev" aria-label="Previous: Application development"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Application development </div> </div> </a> <a href=firmware_packaging.html class="md-footer__link md-footer__link--next" aria-label="Next: Firmware Packaging"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Firmware Packaging </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 - 2025 Nubificus LTD </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.indexes", "navigation.tracking", "navigation.top", "navigation.footer", "toc.follow", "content.code.copy", "content.tabs.link", "search.highlight", "search.suggest", "search.share"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script> <script src=../assets/javascripts/bundle.50899def.min.js></script> <script src=../assets/javascripts/console-copy.2759f0.min.js></script> </body> </html>